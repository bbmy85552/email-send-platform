# NovaMail - ä¸“ä¸šé‚®ä»¶å‘é€å¹³å°

NovaMail æ˜¯ä¸€ä¸ªåŸºäº Next.js çš„ä¸“ä¸šé‚®ä»¶å‘é€å¹³å°ï¼Œé›†æˆ Google OAuth è®¤è¯ã€MySQL æ•°æ®åº“å’Œ Resend APIï¼Œæä¾›å®‰å…¨å¯é çš„é‚®ä»¶å‘é€æœåŠ¡ã€‚

## ğŸš€ ä¸»è¦åŠŸèƒ½

### ğŸ“§ æ™ºèƒ½é‚®ä»¶å‘é€
- **è‡ªå®šä¹‰å‘ä»¶äººä¿¡æ¯**ï¼šæ”¯æŒè‡ªå®šä¹‰å‘ä»¶äººå§“åå’Œé‚®ç®±å‰ç¼€
- **HTMLæ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒHTMLæ ¼å¼çš„é‚®ä»¶å†…å®¹
- **ä¸“ä¸šåŸŸå**ï¼šä½¿ç”¨ novatime.top åŸŸåå‘é€é‚®ä»¶
- **å³æ—¶çŠ¶æ€åé¦ˆ**ï¼šå®æ—¶æ˜¾ç¤ºå‘é€æˆåŠŸ/å¤±è´¥çŠ¶æ€

### ğŸ“Š å‘é€ç»Ÿè®¡è¿½è¸ª
- **å®æ—¶ç»Ÿè®¡**ï¼šå®æ—¶æ˜¾ç¤ºä»Šæ—¥å·²å‘é€é‚®ä»¶æ•°é‡
- **å†å²è®°å½•**ï¼šæŸ¥çœ‹å®Œæ•´çš„é‚®ä»¶å‘é€å†å²è®°å½•
- **çŠ¶æ€è¿½è¸ª**ï¼šæ¯å°é‚®ä»¶çš„å‘é€çŠ¶æ€ï¼ˆæˆåŠŸ/å¤±è´¥/å¾…å‘é€ï¼‰
- **æ—¶é—´æˆ³è®°å½•**ï¼šç²¾ç¡®è®°å½•æ¯å°é‚®ä»¶çš„å‘é€æ—¶é—´

### ğŸ” å®‰å…¨è®¤è¯
- **Google OAuth**ï¼šä½¿ç”¨ Google è´¦æˆ·å®‰å…¨ç™»å½•
- **æ— å¯†ç è®¤è¯**ï¼šæ— éœ€æ³¨å†Œæ–°è´¦æˆ·ï¼Œç›´æ¥ä½¿ç”¨ Google è´¦æˆ·
- **ä¼šè¯ç®¡ç†**ï¼šå®‰å…¨çš„ä¼šè¯å­˜å‚¨å’Œç®¡ç†
- **æƒé™æ§åˆ¶**ï¼šåŸºäºç”¨æˆ·èº«ä»½çš„é‚®ä»¶å‘é€æƒé™ç®¡ç†

### âš™ï¸ ç®¡ç†åŠŸèƒ½
- **æ¯æ—¥é™é¢**ï¼šå¯é…ç½®çš„æ¯æ—¥é‚®ä»¶å‘é€é™åˆ¶ï¼ˆé»˜è®¤10å°/å¤©ï¼‰
- **ç”¨æˆ·ç®¡ç†**ï¼šè‡ªåŠ¨åˆ›å»ºå’Œç®¡ç†ç”¨æˆ·è®°å½•
- **æ•°æ®æŒä¹…åŒ–**ï¼šæ‰€æœ‰é‚®ä»¶è®°å½•å’Œç”¨æˆ·æ•°æ®æŒä¹…åŒ–å­˜å‚¨

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### å‰ç«¯æŠ€æœ¯æ ˆ
- **Next.js 15**ï¼šç°ä»£ React æ¡†æ¶ï¼Œæ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“
- **TypeScript**ï¼šç±»å‹å®‰å…¨çš„å¼€å‘ä½“éªŒ
- **Tailwind CSS**ï¼šç°ä»£åŒ–çš„ CSS æ¡†æ¶
- **Framer Motion**ï¼šæµç•…çš„åŠ¨ç”»æ•ˆæœ
- **Shadcn/ui**ï¼šç¾è§‚çš„ç»„ä»¶åº“

### åç«¯æŠ€æœ¯æ ˆ
- **Next.js API Routes**ï¼šå†…ç½®çš„ API è·¯ç”±ç³»ç»Ÿ
- **MySQL 8.0**ï¼šå…³ç³»å‹æ•°æ®åº“
- **mysql2**ï¼šé«˜æ€§èƒ½ MySQL å®¢æˆ·ç«¯
- **Resend API**ï¼šä¸“ä¸šçš„é‚®ä»¶å‘é€æœåŠ¡
- **Google Identity Services**ï¼šGoogle OAuth è®¤è¯

### å¼€å‘å·¥å…·
- **ESLint**ï¼šä»£ç è´¨é‡æ£€æŸ¥
- **Prettier**ï¼šä»£ç æ ¼å¼åŒ–
- **TypeScript**ï¼šç±»å‹æ£€æŸ¥

## ğŸ“ é¡¹ç›®ç»“æ„

```
email-send/
â”œâ”€â”€ app/                          # Next.js åº”ç”¨ç›®å½•
â”‚   â”œâ”€â”€ api/                     # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ send-email/         # é‚®ä»¶å‘é€API
â”‚   â”‚   â”‚   â””â”€â”€ route.ts        # é‚®ä»¶å‘é€å¤„ç†é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ test-db/            # æ•°æ®åº“æµ‹è¯•API
â”‚   â”‚   â”‚   â””â”€â”€ route.ts        # æ•°æ®åº“è¿æ¥æµ‹è¯•
â”‚   â”‚   â””â”€â”€ user-emails/        # ç”¨æˆ·é‚®ä»¶å†å²API
â”‚   â”‚       â””â”€â”€ route.ts        # è·å–ç”¨æˆ·é‚®ä»¶è®°å½•
â”‚   â”œâ”€â”€ dashboard/page.tsx      # ç”¨æˆ·ä»ªè¡¨æ¿é¡µé¢
â”‚   â”œâ”€â”€ email-compose/page.tsx  # é‚®ä»¶å‘é€é¡µé¢
â”‚   â”œâ”€â”€ globals.css             # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ layout.tsx              # å¸ƒå±€ç»„ä»¶
â”‚   â””â”€â”€ page.tsx                # é¦–é¡µ
â”œâ”€â”€ components/                 # Reactç»„ä»¶
â”‚   â”œâ”€â”€ ui/                     # UIç»„ä»¶åº“
â”‚   â”œâ”€â”€ enhanced-homepage.tsx   # ä¼˜åŒ–åçš„é¦–é¡µ
â”‚   â””â”€â”€ theme-provider.tsx      # ä¸»é¢˜æä¾›è€…
â”œâ”€â”€ hooks/                      # è‡ªå®šä¹‰Hooks
â”‚   â””â”€â”€ use-google-auth.ts     # Googleè®¤è¯Hook
â”œâ”€â”€ lib/                        # å·¥å…·åº“
â”‚   â”œâ”€â”€ db.ts                  # æ•°æ®åº“è¿æ¥å’Œæ“ä½œ
â”‚   â”œâ”€â”€ google-auth.ts         # Googleè®¤è¯é…ç½®
â”‚   â””â”€â”€ utils.ts               # å·¥å…·å‡½æ•°
â”œâ”€â”€ public/                     # é™æ€èµ„æº
â”œâ”€â”€ .env.example               # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”œâ”€â”€ package.json               # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ tsconfig.json              # TypeScripté…ç½®
â”œâ”€â”€ tailwind.config.js         # Tailwindé…ç½®
â””â”€â”€ README.md                  # é¡¹ç›®æ–‡æ¡£
```


## ğŸ”§ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

#### Google OAuth é›†æˆ
- ä½¿ç”¨ Google Identity Services å®ç°æ— å¯†ç ç™»å½•
- è‡ªåŠ¨åˆ›å»ºç”¨æˆ·è®°å½•ï¼ˆé¦–æ¬¡ç™»å½•æ—¶ï¼‰
- å®‰å…¨çš„ä¼šè¯ç®¡ç†

#### ç›¸å…³æ–‡ä»¶ï¼š
- `hooks/use-google-auth.ts` - è®¤è¯Hook
- `lib/google-auth.ts` - Googleè®¤è¯é…ç½®
- `app/page.tsx` - é¦–é¡µç™»å½•å…¥å£

### 2. é‚®ä»¶å‘é€ç³»ç»Ÿ

#### é‚®ä»¶å‘é€æµç¨‹
1. ç”¨æˆ·å¡«å†™é‚®ä»¶ä¿¡æ¯ï¼ˆå‘ä»¶äººã€æ”¶ä»¶äººã€ä¸»é¢˜ã€å†…å®¹ï¼‰
2. ç³»ç»ŸéªŒè¯ç”¨æˆ·èº«ä»½å’Œå‘é€é™é¢
3. è®°å½•é‚®ä»¶åˆ°æ•°æ®åº“
4. è°ƒç”¨ Resend API å‘é€é‚®ä»¶
5. æ›´æ–°é‚®ä»¶å‘é€çŠ¶æ€

#### ç›¸å…³æ–‡ä»¶ï¼š
- `app/api/send-email/route.ts` - é‚®ä»¶å‘é€API
- `lib/db.ts` - æ•°æ®åº“æ“ä½œ
- `lib/resend.ts` - Resendé…ç½®

### 3. æ•°æ®åº“è®¾è®¡

#### æ•°æ®è¡¨ç»“æ„

**å»ºè¡¨**
```sql
-- This script creates the necessary tables and indexes for the email application.
-- It is designed for a MySQL database and uses the InnoDB engine for transaction support and foreign keys.

-- ----------------------------
-- Table structure for users
-- ----------------------------
CREATE TABLE IF NOT EXISTS `users` (
  `id` VARCHAR(36) PRIMARY KEY,
  `email` VARCHAR(255) UNIQUE NOT NULL,
  `name` VARCHAR(255) NOT NULL,
  `picture` VARCHAR(500),
  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  `updated_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ----------------------------
-- Table structure for email_records
-- ----------------------------
CREATE TABLE IF NOT EXISTS `email_records` (
  `id` VARCHAR(36) PRIMARY KEY,
  `user_id` VARCHAR(36) NOT NULL,
  `from_name` VARCHAR(255) NOT NULL,
  `sender_email` VARCHAR(255) NOT NULL,
  `recipient` VARCHAR(255) NOT NULL,
  `subject` VARCHAR(500) NOT NULL,
  `content` TEXT NOT NULL,
  `email_id` VARCHAR(255),
  `status` ENUM('sent', 'failed', 'pending') NOT NULL DEFAULT 'pending',
  `sent_at` TIMESTAMP NULL,
  `created_at` TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ----------------------------
-- Create Indexes
-- Note: The primary key and unique constraints automatically create indexes.
-- These statements create additional indexes for performance optimization on common query patterns.
-- The `IF NOT EXISTS` syntax for `CREATE INDEX` is supported in MySQL 8.0.29+ and MariaDB 10.1+.
-- For older versions, you might need to remove `IF NOT EXISTS` and check for existence manually.
-- ----------------------------

-- Index for quickly finding all email records for a specific user.
ALTER TABLE `email_records` ADD INDEX `idx_email_records_user_id` (`user_id`);

-- Index for sorting email records by their creation date.
ALTER TABLE `email_records` ADD INDEX `idx_email_records_created_at` (`created_at`);

-- Index for quickly looking up users by their email address (though the UNIQUE constraint already creates one).
ALTER TABLE `users` ADD INDEX `idx_users_email` (`email`);


```

### 4. å‰ç«¯ç•Œé¢

#### é¡µé¢ç»“æ„
- **é¦–é¡µ**ï¼šå±•ç¤ºåŠŸèƒ½ä»‹ç»å’Œç™»å½•å…¥å£
- **ä»ªè¡¨æ¿**ï¼šç”¨æˆ·æ¦‚è§ˆå’Œå¿«é€Ÿå¯¼èˆª
- **é‚®ä»¶å‘é€é¡µ**ï¼šå®Œæ•´çš„é‚®ä»¶å‘é€è¡¨å•å’Œå†å²è®°å½•

#### åŠ¨ç”»æ•ˆæœ
- ä½¿ç”¨ Framer Motion å®ç°æµç•…çš„é¡µé¢åŠ¨ç”»
- å“åº”å¼è®¾è®¡ï¼Œé€‚é…å„ç§å±å¹•å°ºå¯¸
- ç°ä»£åŒ–çš„UIè®¾è®¡

## ğŸ“Š API æ¥å£

### é‚®ä»¶å‘é€ API
- **POST** `/api/send-email`
- è¯·æ±‚ä½“ï¼š
```json
{
  "fromName": "å‘ä»¶äººå§“å",
  "senderEmail": "å‘ä»¶é‚®ç®±å‰ç¼€",
  "recipient": "æ”¶ä»¶äººé‚®ç®±",
  "subject": "é‚®ä»¶ä¸»é¢˜",
  "content": "é‚®ä»¶å†…å®¹",
  "userEmail": "ç”¨æˆ·é‚®ç®±"
}
```

### è·å–é‚®ä»¶å†å²
- **GET** `/api/user-emails?email=user@example.com`
- è¿”å›ç”¨æˆ·é‚®ä»¶å‘é€å†å²è®°å½•

## ğŸ¯ ä½¿ç”¨è¯´æ˜

### ç”¨æˆ·æ³¨å†Œ/ç™»å½•
1. è®¿é—®é¦–é¡µ http://localhost:3000
2. ç‚¹å‡»"ä½¿ç”¨ Google è´¦æˆ·ç™»å½•"
3. é€‰æ‹©æ‚¨çš„ Google è´¦æˆ·å¹¶å®Œæˆæˆæƒ
4. è‡ªåŠ¨è·³è½¬åˆ°ä»ªè¡¨æ¿

### å‘é€é‚®ä»¶
1. ç‚¹å‡»å¯¼èˆªæ çš„"å‘é€é‚®ä»¶"
2. å¡«å†™é‚®ä»¶ä¿¡æ¯ï¼š
   - å‘ä»¶äººå§“åï¼ˆæ˜¾ç¤ºç»™æ”¶ä»¶äººï¼‰
   - å‘ä»¶é‚®ç®±å‰ç¼€ï¼ˆå°†æ˜¾ç¤ºä¸º xxx@novatime.topï¼‰
   - æ”¶ä»¶äººé‚®ç®±åœ°å€
   - é‚®ä»¶ä¸»é¢˜
   - é‚®ä»¶å†…å®¹ï¼ˆæ”¯æŒHTMLæ ¼å¼ï¼‰
3. ç‚¹å‡»"å‘é€é‚®ä»¶"æŒ‰é’®
4. æŸ¥çœ‹å‘é€ç»“æœå’Œå†å²è®°å½•

### æŸ¥çœ‹å†å²è®°å½•
- åœ¨é‚®ä»¶å‘é€é¡µé¢å³ä¾§æŸ¥çœ‹å·²å‘é€é‚®ä»¶
- æŸ¥çœ‹æ¯å°é‚®ä»¶çš„å‘é€çŠ¶æ€å’Œæ—¶é—´
- ä½¿ç”¨åˆ·æ–°æŒ‰é’®æ›´æ–°æœ€æ–°è®°å½•

## ğŸš€ éƒ¨ç½²æŒ‡å—

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. **æ„å»ºé¡¹ç›®**
```bash
yarn install
yarn dev
```

2. **ç¯å¢ƒå˜é‡é…ç½®**
ç¡®ä¿ç”Ÿäº§ç¯å¢ƒçš„ç¯å¢ƒå˜é‡å·²æ­£ç¡®é…ç½®

